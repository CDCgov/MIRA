<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title> • MIRA</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="">
<link rel="stylesheet" type="text/css" href="https://...">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MIRA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-mira-in-docker-desktop" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">MIRA in Docker Desktop</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-mira-in-docker-desktop">
<li><a class="dropdown-item" href="../articles/mira-dd-getting-started.html">Getting Started and Installation</a></li>
    <li><a class="dropdown-item" href="../articles/running-mira-dd-ont.html">Running Genome Assembly with MIRA -- NANOPORE DATA</a></li>
    <li><a class="dropdown-item" href="../articles/running-mira-dd-illumina.html">Running Genome Assembly with MIRA -- ILLUMINA DATA</a></li>
    <li><a class="dropdown-item" href="../articles/data-transfer.html">Data Transfer with Mk1C</a></li>
    <li><a class="dropdown-item" href="../articles/upgrading-mira-dd.html">Upgrading MIRA Docker Desktop</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-mira-cli" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">MIRA-CLI</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-mira-cli">
<li><a class="dropdown-item" href="../articles/quick-start-ubuntu.html">Quick Start in Ubuntu</a></li>
    <li><a class="dropdown-item" href="../articles/getting-started.html">PC Getting Started</a></li>
    <li><a class="dropdown-item" href="../articles/mira-cli-mac-getting-started.html">MAC Getting Started</a></li>
    <li><a class="dropdown-item" href="../articles/mira-cli-installation.html">MIRA installation</a></li>
    <li><a class="dropdown-item" href="../articles/running-mira-cli-ont.html">Running Genome Assembly with MIRA-CLI -- NANOPORE DATA</a></li>
    <li><a class="dropdown-item" href="../articles/running-mira-cli-illumina.html">Running Genome Assembly with MIRA-CLI -- ILLUMINA DATA</a></li>
    <li><a class="dropdown-item" href="../articles/upgrading-mira-cli.html">Upgrading MIRA-CLI</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lab-protocols" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Lab Protocols</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-lab-protocols">
<li><h6 class="dropdown-header" data-toc-skip>Sequencing Template Generation</h6></li>
    <li><a class="dropdown-item" href="../articles/automated-rna-extraction.html">Automated RNA Extraction using QIAcube HT</a></li>
    <li><a class="dropdown-item" href="../articles/influenza-a-and-b-mrt-pcr.html">Multi-segment Reverse Transcription-PCR (MRT-PCR) of Influenza A and B Viruses</a></li>
    <li><a class="dropdown-item" href="../articles/influenza-mrt-pcr.html"><span class="fa fa-star"></span> Influenza A Virus MRT-PCR</a></li>
    <li><a class="dropdown-item" href="../articles/sars-cov-2-rt-pcr.html"><span class="fa fa-star"></span> SARS-COV-2 Virus RT-PCR</a></li>
    <li><a class="dropdown-item" href="../articles/mrt-pcr-purification.html">MRT-PCR Purification using Exonuclease</a></li>
    <li><a class="dropdown-item" href="../articles/QIAxcel-sample-preparation-and-quality-control.html">QIAxcel Sample Preparation and Quality Control Procedure</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>Illumina Library Preparation and Sequencing</h6></li>
    <li><a class="dropdown-item" href="../articles/manual-illumina-dna-prep-library.html">Manual Procedure Illumina DNA Library Preparation</a></li>
    <li><a class="dropdown-item" href="../articles/dna-quantification.html">DNA Quantification with Qubit ds DNA High Sensitivity Kit</a></li>
    <li><a class="dropdown-item" href="../articles/miseq-next-generation-seq-run.html">Performing a MiSeq Next Generation Sequencing Run</a></li>
    <li><a class="dropdown-item" href="../articles/miseq-library-loading-preparation.html">Preparation of the DNA Libraries for Loading onto the MiSeq</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>Oxford Nanopore Library Preparation and Sequencing</h6></li>
    <li><a class="dropdown-item" href="../articles/influenza-sars-cov-2-s-gene-amplicons-nanopore.html"><span class="fa fa-star"></span> Library Preparation and Nanopore Sequencing of Influenza and SARS-COV-2 S-gene Amplicons</a></li>
  </ul>
</li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-help" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Help</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-help">
<li><a class="dropdown-item" href="../articles/FAQs.html">FAQs</a></li>
    <li><a class="dropdown-item" href="../articles/troubleshooting.html">Troubleshooting</a></li>
    <li><a class="dropdown-item" href="../articles/sequence-qc.html">QC Standards</a></li>
    <li><a class="dropdown-item" href="../articles/development-tips.html">Development Tips</a></li>
    <li><a class="dropdown-item" href="../articles/nanopore-frameshift-correction.html">Nanopore Frameshift Correction</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-legacy" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Legacy</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-legacy">
<li><a class="dropdown-item" href="../articles/getting-started.html">Retired PC Getting Started</a></li>
    <li><a class="dropdown-item" href="../articles/mac-getting-started.html">Retired MAC Getting Started</a></li>
    <li><a class="dropdown-item" href="../articles/mira-installation.html">Retired MIRA installation</a></li>
    <li><a class="dropdown-item" href="../articles/data-transfer.html">Retired Data Transfer with Mk1C</a></li>
    <li><a class="dropdown-item" href="../articles/running-mira.html">Retired Running Genome Assembly -- NANOPORE DATA</a></li>
    <li><a class="dropdown-item" href="../articles/running-mira-illumina.html">Retired Running Genome Assembly -- ILLUMINA DATA</a></li>
    <li><a class="dropdown-item" href="../articles/training-post-mira.html">Retired Post MIRA sequence analysis with Nextclade</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Change Log</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/CDCgov/MIRA/issues"><span class="fa fa-comments"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/CDCgov/MIRA"><span class="fa fa-github"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1></h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/CDCgov/MIRA/blob/prod/vignettes/nanopore-frameshift-correction.Rmd" class="external-link"><code>vignettes/nanopore-frameshift-correction.Rmd</code></a></small>
      <div class="d-none name"><code>nanopore-frameshift-correction.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="correcting-frameshifts-in-nanopore-mira-data">Correcting Frameshifts in Nanopore MIRA data<a class="anchor" aria-label="anchor" href="#correcting-frameshifts-in-nanopore-mira-data"></a>
</h2>
<p>Oxford Nanopore data is known to have an increased error rate when
calling bases in a homopolymer region.</p>
<p>Ex: if the sequences is AAAAAA, Nanopore might erroneously basecall
AAAAA (deleting one A) which can lead to frameshifts in your final
assembly data.</p>
<p>The MIRA development team is working on adding features that would
auto-correct these homopolymer indels automatically, but in the
meantime, here are instructions and examples for manually fixing
frameshifts in your data.</p>
<p>We will be using JalView to edit our sequences: <a href="https://www.jalview.org/download/" class="external-link uri">https://www.jalview.org/download/</a></p>
<div class="section level3">
<h3 id="h3n2-na-frameshift-correction">H3N2 NA frameshift correction<a class="anchor" aria-label="anchor" href="#h3n2-na-frameshift-correction"></a>
</h3>
<p>At nucleotide position starting 138, H3N2 NA gene has seven Cs in a
row. Nanopore is prone to erroneously deleting one of the seven Cs
(CC-CCCC).</p>
<p>This corresponds to Amino Acid position 44.</p>
<p>The following is an example of frameshift correction for H3N2 samples
with a frameshift at amino acid 44.</p>
<div class="section level5">
<h5 id="how-to-know-if-my-data-has-a-frameshift">How to know if my data has a frameshift?<a class="anchor" aria-label="anchor" href="#how-to-know-if-my-data-has-a-frameshift"></a>
</h5>
<p>There are a couple of ways to know if your data contains a
frameshift.</p>
<p><strong>1. In MIRA output</strong></p>
<p>In the reference variants table for your MIRA output, frameshifts are
represented by a “~” character. You can specifically filter for
instances of “~” by searching in the final column. Here, I searched for
“NA” in my protein column and “~” in my AA Variants column to see 4
samples in my run with the frameshift at NA amino acid position 44.</p>
<p><img src="images%2Fsearch_frameshifts_MIRA.PNG"></p>
<p></p>
<p><strong>2. In Nextclade output</strong></p>
<p>If you loaded all of your NA samples to Nextclade, any sequences with
a frameshift will be flagged in the output. Here is what Nextclade shows
for these 4 NA samples (which I called aa, bb, hh, and mm):</p>
<ul>
<li>Go to <a href="https://clades.nextstrain.org/" class="external-link uri">https://clades.nextstrain.org/</a>
</li>
<li>Make sure you select H3N2 NA as your pathogen</li>
</ul>
<p><img src="images%2Fnextclade_NA_1.PNG"></p>
<p></p>
<ul>
<li>After you select or input your N2 sequences, if the results show an
orange “F” in th QC column, 1 or more in the Gaps column, and a big red
bar in the gene section at the far right, then you have a
frameshift</li>
</ul>
<p><img src="images%2Fnextclade_NA_2.PNG"></p>
<p><strong>3. Fixing the frameshift with JalView</strong></p>
<ul>
<li>Select the download button in the top right corner of Nextclade’s
output, and choose the <strong>nextclade.aligned.fasta</strong>
</li>
</ul>
<p><img src="images%2Fnextclade_NA_3.PNG"></p>
<ul>
<li>Open the downloaded .fasta and scroll to the position with the
frameshift (if you hover over Gaps in Nextclade, it tells us for these
samples, the gap is at nucleotide position 140)</li>
</ul>
<p><img src="images%2Fgaps.PNG"></p>
<ul>
<li>Since we downloaded the aligned .fasta, we should see a “-”
character at position 140 in JalView. Notice all the Cs there? That is
our homopolymer:</li>
</ul>
<p><img src="images%2Fpos_140.PNG"></p>
<ul>
<li><p>TIP: Is your JalView nucleotide size too small and difficult to
read? Click Format –&gt; Font –&gt; Size to make it bigger</p></li>
<li><p>Next, we need to “fill” this gap so that it is no longer a
frameshift. But since we are missing data, we cannot say for certain
that there should be a C here. We just know that there should be a
nucleotide. Therefore, we will fill this gap with an N
character.</p></li>
<li><p>Select the gap by clicking on the “-”, you should see a red box
around it. Right click then choose Selection, Edit, then Edit
Sequence</p></li>
</ul>
<p><img src="images%2Fedit_sequence_jalview.PNG"></p>
<ul>
<li><p>A text box will appear. Replace the “-” with an uppercase “N” and
then click OK</p></li>
<li><p>You have successfully filled a frameshift gap!</p></li>
<li><p>Replace the original sequences in your MIRA multifasta! First,
open the original .fasta in Jalview and select the frameshift samples,
then type the delete key on your keyboard. Then, you can copy and paste
the “fixed” sequence from your nextclade.aligned.fasta JalView window
into your MIRA multifasta Jalview window and save.</p></li>
<li><p>Now, when you run Nextclade on the “fixed” sequences, you will
see 0 gaps and 0 frameshifts:</p></li>
</ul>
<p><img src="images%2Fnextclade_NA_4.PNG"></p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/kristinelacek" class="external-link">Kristine Lacek</a>, <a href="https://github.com/rchau88" class="external-link">Reina Chau</a>, <a href="https://github.com/mandysulli" class="external-link">Amanda Sullivan</a>, <a href="https://github.com/nbx0" class="external-link">Ben Rambo-Martin</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
